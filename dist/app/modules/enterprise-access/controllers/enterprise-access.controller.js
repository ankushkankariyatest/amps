!function(){define(["assetIt","enterprise-access-service","ui-bootstrap"],function(e){e.register.controller("enterpriseAccessController",["$scope","$rootScope","enterpriseAccessService","authenticationFactory","notifyService",function(e,o,i,s,t){var r={isInvalidLanId:{message:"This is not a valid LAN ID",isValid:!1},isEmpty:{message:"This field is required",isValid:!1},sameLanIdAndSupervisorId:{message:"LAN ID and Supervisor LAN ID cannot be same",isValid:!1},defaultErrorInfo:{isValid:!0,message:""}},n=function(t){var n=a(t);if(n.isValid){var e=t,i=/(.*)@(.*)/.exec(t);return i&&i[2]?(e=i[1],e.toLowerCase()===s.lanid?r.sameLanIdAndSupervisorId:"pge.com"!=i[2]||4!=e.length||/[^a-zA-Z0-9]/.test(e)?r.isInvalidLanId:r.defaultErrorInfo):e.toLowerCase()===s.lanid?r.sameLanIdAndSupervisorId:/[^a-zA-Z0-9]/.test(e)||4!=e.length?r.isInvalidLanId:r.defaultErrorInfo}return n},a=function(e){return void 0!==e&&""!==String(e).trim()?r.defaultErrorInfo:r.isEmpty};e.enterprise={lanId:s.lanid,supervisorLanId:"",businessJustification:"",workOrder:s.workOrder},e.submitEnterprise=function(a){var r=n(e.enterprise.supervisorLanId);return r.isValid?void i.sendEnterpriseAccessRequest(e.enterprise).then(function(r){return a.close(),r.isSuccess?(t.notifySuccess({title:"Asset Management Platform",text:r.message,type:"success"}),void(r.workOrder&&s.setWorkOrder(r.workOrder))):(e.error={isValid:r.isSuccess,message:r.message},void("$apply"!=e.$root.$$phase&&"$digest"!=e.$root.$$phase&&e.$apply()))}):(e.error=r,void("$apply"!=e.$root.$$phase&&"$digest"!=e.$root.$$phase&&e.$apply()))}}])})}();
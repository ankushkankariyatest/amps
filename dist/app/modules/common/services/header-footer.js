!function(){"use strict";define(["angularAMD","auth-service","bootstrap-popup"],function(){var e=angular.module("assetItAuthentication");e.factory("headerFooterDecisionMaker",["$document","$q","$compile","authenticationFactory","configOptions","environments","authService",function(n,i,e,s,r,t,o){var a={};return a.defineHeader=function(o){var l=n[0],a=angular.element(l.getElementById("dynamic-header-info")),c=angular.element(l.getElementById("dynamic-footer-info"));if(a.empty(),c.empty(),s.isLogged)a.append(e("<div asset-header></div>")(o)),c.append(e('<div class="asset-footer-anchor">Sprint Version: '+r.frontEndVersion+'<a class="pointer " data-ng-click="openFeedback()" >Feedback?</a></div>')(o));else{var i='<div class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right assetIT-main-top-right"><li class="dropdown"><a class="dropdown-toggle" role="button" data-toggle="dropdown" href="javascript:void(0);"><span class="assetIT-header-nav_welcome_txt">'+t.activeEnvironment+'<span class="caret"></span> </span></a><ul id="environment" class="dropdown-menu" role="menu">';_.each(t.info,function(e,t){i+='<li><a href="'+e.href+'">'+e.text+"</a></li>"}),i+="</ul></li></ul></div>",a.append(i)}},a}]),e.directive("assetHeader",["$window","$location","authenticationFactory","authService","appConstantPath","svcStorage","environments","externalLinks",function(t,a,e,n,s,r,i,o){return{restrict:"AE",templateUrl:s.header.templateUrl,link:function(s,u,d,p,m){s.environments=i;var l=function(){s.menuItems=[],s.disabledItems=[],s.loginActive=!1,s.user="",r.removeAll(),window.localStorage.clear(),n.logout()},c=function(){s.loginActive=e.isLogged,e.isLogged?(s.menuItems=[{text:"Home",routePath:"home",base:"/home",css:"",target:"_self",isDisabled:!1,displayToUi:!0,isExternal:!1},{text:"Applications",routePath:"applications",base:"/applications",css:"",target:"_self",isDisabled:!1,displayToUi:!0,isExternal:!1},{text:"MCPs",routePath:"mcps",base:"/mcps",css:"",target:"_self",isDisabled:!1,displayToUi:!0,isExternal:!1},{text:"LOBs",routePath:"lobs",base:"/lobs",css:"",target:"_self",isDisabled:!1,displayToUi:!0,isExternal:!1},{text:"Infrastructure",routePath:"infrastructure",base:"/infrastructure",css:"",target:"_self",isDisabled:!1,displayToUi:!0,isExternal:!1},{text:"BCA Inventory",routePath:"sites",base:"/sites",css:"hidden-xs",target:"_self",isDisabled:!1,displayToUi:-1!==$.inArray(e.userRoles.nercCip,e.userRole),isExternal:!1}],_.each(o,function(t,r){if(t.active){for(var n={},a=0;a<t.params.length;a++)n[t.params[a]]="object"==typeof e[t.params[a]]?e[t.params[a]].join():e[t.params[a]],n[t.params[a]]="token"==t.params[a]?e.getAuthToken():n[t.params[a]];s.menuItems.push({text:t.label,routePath:t.url,routeParams:"GET"===t.method?"?"+$.param(n):t.params,target:"_blank",isDisabled:!1,displayToUi:t.roles&&t.roles.length>0?_.intersection(t.roles,e.userRole).length>0:!0,isExternal:!0,method:t.method})}}),s.user=t.localStorage.user,s.fullName=t.localStorage.fullName):l()};c(),s.routeChange=function(e){a.path("/"+e.routePath)},s.logout=function(){l()},s.isAdmin=-1!==$.inArray(e.userRoles.admin,e.userRole),s.isNercCip=-1!==$.inArray(e.userRoles.nercCip,e.userRole),s.isActive=function(e){return-1!=a.path().indexOf(e)},s.showAlert=!1,s.navigateWithPost=function(a){var t=$(document.createElement("form")).css({display:"none"}).attr("method","POST").attr("target","_blank").attr("action",a.routePath);_.each(a.routeParams,function(a,n){"object"==typeof e[a]?t.append($(document.createElement("input")).attr("name",a).val(e[a].join())):"token"===a?t.append($(document.createElement("input")).attr("name",a).val(e.getAuthToken())):t.append($(document.createElement("input")).attr("name",a).val(e[a]))}),$("body").append(t),t.submit()}}}}])})}();
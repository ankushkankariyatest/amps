!function(){"use strict";define(["assetIt"],function(o){o.register.directive("gridGrouping",function(){return{restrict:"AE",templateUrl:"app/modules/common/grid-grouping/grid-grouping.html",scope:{options:"=",callbackGroup:"&?"},link:function(o,e,t){e.find(".k-grouping-header").on("click","a.k-button.k-button-icon.k-button-bare",function(r){for(var i=$(r.currentTarget).attr("data-field"),e=o.groupByCol.activeGroupByColumns,t=e.length;t--;)i==e[t].field&&(o.groupByCol.columns[i].isSelected=!1,e.splice(t,1),$("#grid").getKendoGrid().dataSource.group(e),o.$evalAsync(o.callbackGroup()));"$apply"!=o.$root.$$phase&&"$digest"!=o.$root.$$phase&&o.$apply()})},controller:["$scope",function(o){o.$on("$destroy",o.$watch("options",function(e,r){if(void 0!==e&&e&&e!=r){var l=_.object(_.pluck(e.columns,"field"),e.columns);o.groupByCol={activeGroupByColumns:e.activeGroupColumns,columns:l,groupByCols:function(t,e){if(t.preventDefault(),!e.isSelected){e.isSelected=!0;var i=_.indexBy(this.activeGroupByColumns,"field"),r=i[e.field];if(!r){var l={field:e.field,title:e.title,aggregates:[{field:e.field,aggregate:"count"}]};this.activeGroupByColumns.push(l),$("#grid").getKendoGrid().dataSource.group(this.activeGroupByColumns),o.$evalAsync(o.callbackGroup())}}}};var t=o.groupByCol.activeGroupByColumns;if(t){for(var i=t.length;i--;)o.groupByCol.columns[t[i].field].isSelected=!0;t&&t.length>0&&($("#grid").getKendoGrid().dataSource.group(t),o.$evalAsync(o.callbackGroup()))}}},!0))}]}})})}();
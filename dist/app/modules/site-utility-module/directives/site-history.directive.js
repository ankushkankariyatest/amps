!function(){"use strict";define(["assetIt","GlobalFilters"],function(e){e.register.controller("siteHistoryController",["$scope","siteUtilityModuleServices","popupService",function(e,a,s){var t=this;t.showVersionDetail=function(e){var r=_.find(t.siteDetail,{version:e}).recordData;s.showSiteHistoryDetails({rowData:r})};var r="",o=[];_.each(e.keys,function(t,a){o.push({col:t,val:e.rowData[t]}),r=""===r?e.rowData[t]:r+" "+e.rowData[t]});var i={sheetName:e.sheetName,key:o};a.getHistoryData(i).then(function(e){e=_.sortBy(e,"createdAt").reverse(),t.title=r;for(var o=0;o<e.length;o++)o===e.length-1?e[o].comment="added":(angular.equals(e[o].recordData,e[o+1].recordData)?e[o].comment="no change":_.keys(e[o].recordData).length!==_.keys(e[o+1].recordData).length?e[o].comment="changed attributes for ":e[o].comment="changed values for ",e[o].compareKeysData=_.union(_.keys(e[o].recordData),_.keys(e[o+1].recordData)));_.each(e,function(t,r){r!==e.length-1||(t.comment="added")}),t.siteDetail=e})}]),e.register.directive("siteHistory",function(){return{restrict:"AE",templateUrl:"app/modules/site-utility-module/templates/site-tabs/site-history.html",scope:{rowData:"=",sheetName:"=",cols:"=",title:"@",keys:"="},controller:"siteHistoryController",controllerAs:"siteHistoryCtrl",link:function(e,t,r){}}})})}();